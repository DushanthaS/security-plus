# 1.0 Threats, Attacks and Vulnerabilities

## 1.1 Given a scenario, analyze indicators of compromise and determine the type of malware. ([Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9827006#overview))

- Viruses ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836596#overview))
  - "A virus is a piece of mali- cious code that replicates by attaching itself to another piece of executable code." (Conklin)
  - Armored. "Some malware, such as the Zeus Trojan, employs encryption in ways to prevent criminals from stealing the intellectual property of the very malware that they use." (Conklin)
- Crypto-malware ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836594#overview))
  - "Crypto-malware is an early name given to malware that encrypts files on a system and then leaves them unusable either permanently, acting as a denial of service, or temporar- ily until a ransom is paid, making it ransomware." (Conklin)
- Ransomware ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836640#overview))
  - "Ransomware is a form of malware that performs some action and extracts ransom from a user." (Conklin)
- Worm ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836604#overview))
  - "Worms are pieces of code that attempt to penetrate networks and computer systems." (Conklin)
- Trojan ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836608#overview))
  - "A Trojan horse, or simply Trojan, is a piece of software that appears to do one thing (and may, in fact, actually do that thing) but hides some other functionality." (Conklin)
- Rootkit ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836814#overview), [James Messer](https://www.youtube.com/watch?v=GpoWRVA4QXE&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=7))
  - "Rootkits are a form of malware that is specifically designed to modify the operation of the operating system in some fashion to facilitate nonstandard functionality." (Conklin)
- Keylogger ([James Messer](https://www.youtube.com/watch?v=OqS6CDP8N2w&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=8))
  - "A piece of software that logs all of the keystrokes that a user enters." (Conklin)
- Adware ([James Messer](https://www.youtube.com/watch?v=pO_ln-cSY0Y&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=9))
  - "Software that is supported by advertising is called adware." (Conklin)
- Spyware ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836642#overview))
  - "Spyware is software that “spies” on users, recording and reporting on their activities." (Conklin)
- Bots ([James Messer](https://www.youtube.com/watch?v=5kA2ney8r1Y&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=10))
  - "A bot is a functioning piece of software that performs some task, under the control of another program." (Conklin)
- RAT ([James Messer](https://www.youtube.com/watch?v=ib8Phu54VYc&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=6))
  - "A remote-access Trojan (RAT) is a toolkit designed to provide the capability of covert surveillance and/or the capability to gain unauthorized access to a target system." (Conklin)
- Logic bomb ([James Messer](https://www.youtube.com/watch?v=aUemRyeKJs4&list=PLG49S3nxzAnnVhoAaL4B6aMFDQ8_gdxAy&index=11))
  - "A logic bomb is a piece of code that sits dormant for a period of time until some event or date invokes its malicious payload." (Conklin)
- Backdoor ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12838190#overview))
  - "Used to refer to programs that attackers install after gaining unauthorized access to a system to ensure that they can continue to have unrestricted access to the system, even if their initial access method is discovered and blocked." (Conklin)

## 1.2 Compare and contrast types of attacks. ([Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9826926#overview))

### 1.2.1 Social engineering ([Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219886#overview), [Mike Meyers 1](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9828990#overview), [Mike Meyers 2](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9828998#overview))

- Principles (reasons for effectiveness) ([James Messer](https://www.youtube.com/watch?v=xrdYV7bXQVc&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=17))
  - Authority
    - "I'm calling from the help desk."
  - Intimidation
    - "There will be bad things if you don't help."
  - Consensus
    - "Your co-worker Jill did this for me last week."
  - Scarcity
    - "This situation will not be this way for long."
  - Familiarity
    - "We have common friends."
  - Trust
    - "I'm from IT. I am here to help."
  - Urgency
    - "Act quickly, don't think!"
- Watering hole attack ([James Messer](https://www.youtube.com/watch?v=cqvaD2Do7UI&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=16), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219900#overview))
  - Going where people in a company visit, and infecting those locations.
  - e.g. sandwich shops, coffee shops
- Phishing ([James Messer](https://www.youtube.com/watch?v=Y68_ZPlj6Ow), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219898#overview))
  - Spam that tries to get information out of you.
  - e.g. collects login info.
  - Replicated login pages
  - Vishing
    - Over the phone
  - Spear phishing
    - Targeted phishing; focus on narrow group
  - Whaling
    - Targeting toward CEO, highest levels, etc.
- Tailgating ([James Messer](https://www.youtube.com/watch?v=7n10Bt6OtGY))
  - Using someone else to gain entry into building
  - Blend in with clothing
  - Policy for visitors (e.g. badges)
  - Scan one person at a time
  - Man traps, air locks
  - Train to ask: Who are you? why are you here?
- Impersonation ([James Messer](https://www.youtube.com/watch?v=7n10Bt6OtGY))
  - Pretending to be someone you aren't
  - Never volunteer information
  - Call back, verify through 3rd parties
- Dumpster diving ([James Messer](https://www.youtube.com/watch?v=jX6z6Ne4ekI), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219900#overview))
  - Valuable information left in trash
  - Technically legal in all 50 states, but not on private property
  - Secure garbage
  - Shred or even burn
- Shoulder surfing ([James Messer](https://www.youtube.com/watch?v=gLKeYf2zLCQ), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219900#overview))
  - Overlook sensitive information
  - Binoculars / telescopes
  - Web cam
  - Privacy filter
  - Keep monitor out of sight
- Hoax ([James Messer](https://www.youtube.com/watch?v=g0tjeIRZdU8&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=15), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/13219900#overview))
  - Consider the source
  - Cross reference

### 1.2.2 Application/service attacks ([Mike Meyers 1](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9876490#overview), [Mike Meyers 2](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9829002#overview))

- DoS: Denial of Service ([James Messer](https://www.youtube.com/watch?v=Y9LFN4Ajw6c&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=18&t=3s), [Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9826924#overview))
  - Overload the service
  - Sometimes not malicious; service overwhelmed
  - Sometimes accidental: network loop
  - DDoS
    - Distributed; many computers
    - Botnets
    - Asymmetric threat
    - Amplification: reflected off third-party service
- Man-in-the-middle ([James Messer](https://www.youtube.com/watch?v=EHCN1uzac_w&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=19), [Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9826928#overview))
  - Between two devices
  - Directs traffic, forwards
  - ARP poisoning
    - Spoofs IP/MAC responds with false identification of device
  - Man-in-the-browser
    - Malware/Trojan sets proxy on browser to redirect requests
- Buffer overflow ([James Messer](https://www.youtube.com/watch?v=TSeqEN-ZXe4&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=20]))
  - Overwrite buffer of memory
  - Spills over into other memory areas
  - Developers need to perform bounds checking
- Injection ([James Messer](https://www.youtube.com/watch?v=81yiRyGG29Y&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=21))
  - SQL injection; input not santizied, validated
  - XML injection and LDAP injection
- XSS: Cross-site scripting ([James Messer](https://www.youtube.com/watch?v=AjsYOMatAcg&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=22), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12840134#overview))
  - Takes advantage of the trust user has for a site
  - Non-persistent (reflected) XSS attack
    - Web site allows script to run in user input
  - Persistent (stored) XSS attack
    - e.g. post a message to social network with malicious payload
    - Everyone gets the payload
  - Don't blindly click in email inbox
  - Validate input
- XSRF, CSRF: Cross-site request forgery ([James Messer](https://www.youtube.com/watch?v=rbP2jwEDlBM&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=23))
  - One-click attack; Session riding
  - Sea surf
  - Takes advantage of session trust
  - Apps need anti-forgery techniques
  - Ensure requests originated from user's device
- Privilege escalation ([James Messer](https://www.youtube.com/watch?v=KDIfL6meNQs&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=24))
  - Bugs or design flaws that allow one to gain higher-level access
  - Some escalations are horizontal
- DNS poisoning ([James Messer](https://www.youtube.com/watch?v=c76GbfM_QsI&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=25))
  - Sends people to IP address they didn't intend
- Domain hijacking ([James Messer](https://www.youtube.com/watch?v=c76GbfM_QsI&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=25))
  - Changes which DNS server is used for a domain
- Zero day ([James Messer](https://www.youtube.com/watch?v=0zeEGYENgoo&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=27))
  - Exploits vulnerability no one else knows exist
  - Bad guys keep yet-to-be-discovered holes to themselves
  - CVE: cve.mitre.org
- Replay ([James Messer](https://www.youtube.com/watch?v=jy8USm8pIYM&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=28))
  - If one has access to network packets, they might replay the packets, making themselves look like original user.
  - Don't require being in the middle
  - Avoid with unique salts and encryption
- Pass the hash
  - "The attacker captures the hash used to authenticate a process. They can then use this hash by injecting it into a process in place of the password. This is a highly technical attack, targeting the Windows authentication process, injecting a copy of the password hash directly into the system. The attacker does not need to know the password, but instead can use a captured hash and inject it directly, which will verify correctly, granting access." (Conklin)
- Hijacking and related attacks ([James Messer](https://www.youtube.com/watch?v=f2VK7jq-s5A&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=29))
  - Clickjacking
  - Session hijacking
  - URL hijacking
  - Typo squatting
- Driver manipulation ([James Messer](https://www.youtube.com/watch?v=yQb2A-KoA6Y&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=26))
  - Shimming
  - Refactoring
- MAC spoofing ([James Messer](https://www.youtube.com/watch?v=Esqo90Lg4PQ&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=30))
- IP spoofing ([James Messer](https://www.youtube.com/watch?v=Esqo90Lg4PQ&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=30))

### 1.2.3 Wireless attacks

- Replay ([James Messer](https://www.youtube.com/watch?v=1Mx4Ld7PF0s&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=31))
- IV ([James Messer](https://www.youtube.com/watch?v=dEkb-D_q34s))
- Evil twin ([James Messer](https://www.youtube.com/watch?v=XqAn2iR9Cc0&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=32))
- Rogue AP ([James Messer](https://www.youtube.com/watch?v=XqAn2iR9Cc0&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=32))
- Jamming ([James Messer](https://www.youtube.com/watch?v=wqq_uWVqFso&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=33))
- WPS ([James Messer](https://www.youtube.com/watch?v=drHyM--ZY5c&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=34))
- Bluejacking ([James Messer](https://www.youtube.com/watch?v=ofTKPoLOxnA&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=35))
- Bluesnarfing ([James Messer](https://www.youtube.com/watch?v=ofTKPoLOxnA&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=35))
- RFID ([James Messer](https://www.youtube.com/watch?v=GXck1pf7-KE&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=36))
- NFC ([James Messer](https://www.youtube.com/watch?v=GXck1pf7-KE&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=36))
- Disassociation ([James Messer](https://www.youtube.com/watch?v=nRIND-GNiLM&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=37))

### 1.2.4 Cryptographic attacks ([James Messer](https://www.youtube.com/watch?v=wjcT1A2CGJo&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=38))

- Birthday
  - Hash collision.
- Known plain text/cipher text
- Rainbow tables
  - "Precomputed tables or hash values associated with passwords. Using rainbow tables can change the search for a password from a computational problem to a lookup problem." (Conklin)
- Dictionary
  - "Uses a list of dictionary words to try to guess the password." (Conklin)
- Brute force
  - "Password-cracking program attempts all possible password combinations." (Conklin)
  - Online vs. offline
- Collision
- Downgrade
  - "Attacker takes advantage of a commonly employed principle to support backward compatibility, to downgrade the security to a lower or nonexistent state." (Conklin)
- Replay
- Weak implementations

## 1.3 Explain threat actor types and attributes. ([James Messer](https://www.youtube.com/watch?v=_c61C63lFMg&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=39), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12836406#content))

- Types of actors
  - Script kiddies
    - Runs pre-made scripts
    - Might not know what they're doing
    - Not sophisticated
  - Hacktivist
    - Hacker with a purpose
    - Social change or political agenda
    - Can be sophisticated
    - Deface web site
    - Funding is limited
  - Organized crime
    - Outside of network
    - Usually motivated by money
  - Nation states/APT
    - Governments
    - External entity
    - Highest sophistication
    - APT: Advanced persistent threat
  - Insiders
    - Has institutional knowledge
    - Knows what to hit
  - Competitors
    - DoS, espionage, harm reputation
    - High sophistication
- Attributes of actors
  - Internal/external
    - "Internal actors have access to the system... External actors have an additional step, the establishment of access to the system under attack." (Conklin)
  - Level of sophistication
    - "The greater the skill level the more an individual will be expected to lead and design the attacks." (Conklin)
  - Resources/funding
    - "Criminal organizations and nation states have larger budgets, big- ger teams, and the ability to pursue campaigns for longer periods of time." (Conklin)
  - Intent/motivation
- Use of open-source intelligence
  - "Open source intelligence, sometimes called open source threat intelligence, refers to intel- ligence data collected from public sources." (Conklin)

## 1.4 Explain penetration testing concepts. ([James Messer](https://www.youtube.com/watch?v=AbVbqF-UmHc&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=40), [Jason Dion](https://www.udemy.com/program/comptia-security/learn/2015076/lecture/12840126#overview), [Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9876496#overview))

- Passive reconnaissance
  - Gather information
  - Learn from open sources
    - Social media
    - Corporate web site
    - Reddit, forums
    - Social engineering
  - Doesn't require touching the equipment
- Active reconnaissance
  - Often done with vulnerability scan
  - Ping scans
  - Port scans
  - DNS queries
  - Service scans, version scans
- Exploiting vulnerabilities
  - Break into system
  - Gain privilege escalation
  - Be careful; can cause DoS or loss of data
  - Password bruce-force
  - Database injection
  - Buffer overflow
- Initial exploitation
  - Get into the network
  - A challenging hurdle (most of the time)
  - Secure way back in; backdoor
  - Build user accounts
- Pivot
  - Foothold point
  - Inside of network relatively open
  - Jump from here to rest of network
- Levels of information
  - Black box
    - Pentester knows nothing
    - Blind test
  - White box
    - Full disclosure
  - Grey box
    - Mix of black and white
    - Focus on certain applications
- Popular tool: Metasploit
- Escalation of privilege
  - "The movement from a lower-level account to an account that enables root-level activity." (Conklin)
- Persistence
  - "APT actors tend to be very patient and use techniques that make it very difficult to remove them once they have gained a foothold. Persistence can be achieved via a wide range of mechanisms, from agents that beacon back out, to malicious accounts, to vulnerabilities introduced to enable reinfection." (Conklin)
- Penetration testing vs. vulnerability scanning
  - Vulnerability scanning
    - See if vulnerability exists
  - Pentest
    - Simulates an attack
    - Tries to exploit
  - With DoS attack: "Penetration testing will give you a detailed account of whether a network has the capability to detect and respond to a denial-of-service attack." (uCertify)
  - Penetration testing: active
  - Vulnerability scanning: passive

## 1.5 Explain vulnerability scanning concepts. ([James Messer](https://www.youtube.com/watch?v=HukLd-6C4Ew&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=41), [Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9828984#overview))

- Passively test security controls
- Identify lack of security controls
- Identify common misconfigurations
- Intrusive vs. non-intrusive scan
  - Non-intrusive
    - Don't exploit
    - Packet-capture & analysis
  - Intrusive
    - Try out vulnerability; don't takd advantage of it
- Credentialed vs. non-credentialed
  - Non-credentialed
    - No access, user/pass
  - Credentialed
    - Provided with user/pass
    - Emulates insider attack
- Identify vulnerability
  - Signature are the key
- False positive
  - Vulnerability identified that doesn't really exist
- False negatives
  - Vulnerability existed, but wasn't discovered

See also:

- nikto
  - scans servers
  - identifies vulnerabilities

## 1.6 Explain the impact associated with types of vulnerabilities. ([James Messer](https://www.youtube.com/watch?v=1UNCDsrDTu4&list=PL5ysgoFoCpZEM8cboeHdRDePc2bOU9CN1&index=42), [Mike Meyers](https://www.udemy.com/course/comptia-security-certification-sy0-501-the-total-course/learn/lecture/9876502#overview))

- Race conditions
  - Programming conundrum
  - Async, sequencing needs validation
- Vulnerabilities due to:
  - End-of-life systems
    - No longer under support
    - No more security patches
    - End-of-life systems
  - Embedded systems
    - Often have outdated OS software
    - Upgrade... if you can
    - Malware takes advantages of vulnerabilities
  - Lack of vendor support
    - Vendors need to patch vulnerabilities
    - In a timely manner
- Improper input handling
  - All input should be considered malicious
  - SQL injections, buffer overlfows
  - Validate, sanitize data
- Improper error handling
  - Don't show too much error details to user
  - Hide stack traces, DB dumps, memory dumps to public
  - Right amount of detail
- Misconfiguration/weak configuration
  - Turn off debuggers, defaults
- Default configuration
  - "Default configuration is the configuration that a system enters upon start, upon recover- ing from an error, and at times when operating." (Conklin)
- Resource exhaustion
  - "Resource exhaustion is the state where a system does not have all of the resources it needs to continue to function." (Conklin)
- Untrained users
  - Training is critical
  - Quiz and role play
  - Become familiar with common situations
- Improperly configured accounts
  - Frequent audits needed
  - Abanadoned and unnecessary accounts
  - Accounts with administrative access
- Vulnerable business processes
- Weak cipher suites and implementations
  - Protocol
  - Length of encryption key
  - Hash used for integrity check
- Memory/buffer vulnerability
  - Memory leak
    - Memory allocated, never properly released
    - Slowly grows in size
    - System crashes
  - Integer overflow
    - Large number into a smaller sized space
  - Buffer overflow
    - Overwriting a buffer of memory
    - Spills over into other memory areas
  - Pointer dereference
    - Dereferencing address that points to nothing
    - App crashes
  - DLL injection
    - "Dynamic link libraries (DLLs) are pieces of code that can add functionality to a program through the inclusion of library routines linked at run time. DLL injection is the process of adding to a program at run time a DLL that has a specific vulnerability of function that can be capitalized upon by an attacker. " (Conklin)
- System sprawl/undocumented assets
  - Keeping track of resources is a challenge
  - Forgotten or misplaced devices
- Architecture/design weaknesses
  - Proper locks on systems
  - Examine every part of network
- New threats/zero day
  - There isn't always time to properly test
  - Balance severity with stability
  - WannaCry
- Improper certificate and key management
  - Management needs to be well planned
